<%- include("partials/subpage-header") %>

<div class="category-container container">
    <h1 class="category-text mb-4 text-center"><%= title %></h1>

    <div class="blogPosts-container d-flex flex-wrap justify-content-around align-items-center">
        <% if (posts.length === 0) { %>
        <p class="text-muted text-center">No posts available in this category yet.</p>
        <% } else { %>
        <% posts.forEach(post => { %>
            <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
            <a href="/posts/<%= category %>/<%= post.id %>" style="text-decoration: none; color: black;">
                <div class="blogPost-content category-page">
                <% const imgMatch = post.content.match(/<img[^>]*src="([^"]*)"/); %>
                <% if (imgMatch) { %>
                    <img src="<%= imgMatch[1] %>" alt="preview" style="width: 100%; max-height: 270px; object-fit: cover; border-radius: 8px;">
                <% } %>
                <h4 class="mt-3"><%= post.title %></h4>
                <p><%= post.content.replace(/<[^>]+>/g, '').substring(0, 120) %>...</p>
                </div>
            </a>
            </div>
        <% }) %>
        <% } %>
    </div>
</div>
<div class="d-flex justify-content-center my-5">
    <a class="backToHome" href="/#<%= category %>">Back to Home</a>
</div>

<%- include("partials/footer.ejs") %>
